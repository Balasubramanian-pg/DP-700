## Check your knowledge

![[Pasted image 20250803135959.png]]
1. Which of the following sets of layers are typically associated with the Medallion Architecture for data management
	1. Raw, Polished, Refined
	2. **Bronze, Silver, Gold**
	3. Initial, Intermediate, Final

2. Which tool is best suited for data transformation in Fabric when dealing with large-scale data that will continue to grow
	1. Dataflows (Gen2)
	2. Pipelines
	3. **Notebooks**

3. What is the benefit of storing different layers of your lakehouse in separate workspaces?
	1. **It can enhance security, manage capacity use, and optimize cost-effectiveness.**
	2. It makes it easier to share data with colleagues.
	3. There's no benefit of storing different layers of your lakehouse in separate workspaces.



## Question 1: Medallion Architecture Layers

**Correct Answer: B. Bronze, Silver, Gold**

The medallion architecture uses a three-tier approach with specific naming conventions:

- **Bronze Layer**: Raw, unprocessed data ingested from source systems
- **Silver Layer**: Cleaned, validated, and enriched data with business logic applied
- **Gold Layer**: Business-ready data optimized for analytics and reporting

This terminology originated from Databricks and has become the industry standard. The other options (Raw/Polished/Refined and Initial/Intermediate/Final) are not the standard medallion architecture terminology, though they describe similar concepts.

## Question 2: Data Transformation Tools for Large-Scale Data

**Correct Answer: C. Notebooks**

For large-scale data that will continue to grow, **Notebooks** are the best choice because:

**Advantages of Notebooks for Large-Scale Data**:

- **Apache Spark Integration**: Direct access to Spark's distributed computing capabilities
- **Scalability**: Can handle petabyte-scale datasets through horizontal scaling
- **Flexibility**: Support for complex transformations, machine learning, and custom logic
- **Performance Optimization**: Fine-grained control over partitioning, caching, and optimization
- **Language Support**: Python, SQL, Scala, and R for diverse transformation needs

**Why not the other options**:

- **Dataflows (Gen2)**: Better for smaller-scale, visual ETL scenarios with limited scalability
- **Pipelines**: Excellent for orchestration but not the transformation engine itself

```python
# Example: Large-scale transformation in Notebooks
# Can process billions of records efficiently
large_dataset = spark.read.format("delta").table("bronze_transactions")
transformed_data = large_dataset.filter(col("amount") > 0) \
    .withColumn("processed_date", current_date()) \
    .groupBy("customer_id", "product_category") \
    .agg(sum("amount").alias("total_spent"))

transformed_data.write.format("delta").mode("overwrite").saveAsTable("silver_customer_spending")
```

## Question 3: Benefits of Separate Workspaces for Different Layers

**Correct Answer: A. It can enhance security, manage capacity use, and optimize cost-effectiveness**

Storing different medallion layers in separate workspaces provides several strategic advantages:

### Security Benefits

```python
# Example security model across workspaces
workspace_security = {
    "bronze_workspace": {
        "access": ["data_engineers", "data_platform_team"],
        "permissions": ["read_raw_data", "write_bronze_tables"],
        "restrictions": "no_business_user_access"
    },
    "silver_workspace": {
        "access": ["data_engineers", "data_analysts", "data_scientists"],
        "permissions": ["read_validated_data", "create_analysis"],
        "restrictions": "no_raw_data_access"
    },
    "gold_workspace": {
        "access": ["all_business_users", "reporting_tools"],
        "permissions": ["read_business_ready_data", "create_reports"],
        "restrictions": "read_only_for_most_users"
    }
}
```

### Capacity Management Benefits

- **Resource Isolation**: Each layer can have dedicated compute resources
- **Performance Optimization**: Bronze can use batch-optimized capacity, Gold can use query-optimized capacity
- **Cost Control**: Different pricing tiers for different usage patterns

### Cost-Effectiveness Benefits

- **Granular Billing**: Track costs per layer/domain
- **Optimized Storage**: Different retention policies per workspace
- **Compute Optimization**: Right-size capacity for each layer's workload patterns

### Additional Benefits

```python
# Workspace isolation enables:
governance_benefits = {
    "data_lineage": "clear_boundaries_between_processing_stages",
    "compliance": "separate_audit_trails_per_layer",
    "development_lifecycle": "independent_deployment_cycles",
    "team_autonomy": "domain_teams_can_own_their_gold_layer",
    "disaster_recovery": "layer_specific_backup_and_recovery_strategies"
}
```

**Why not the other options**:

- **Option B** (easier data sharing): While true to some extent, this is not the primary benefit and can actually make sharing more complex
- **Option C** (no benefit): This is incorrect as there are significant architectural, security, and operational benefits

The separate workspace approach aligns with modern data mesh principles, enabling distributed data ownership while maintaining centralized governance and standards.